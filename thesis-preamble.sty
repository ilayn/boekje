%!TEX root = thesis.tex
\ProvidesPackage{thesis-preamble}

\edef\thesisjobname{\jobname}
\newcommand\chapterinclude[1]{%
  \def\jobname{#1}
  \include{#1}
  \let\jobname\thesisjobname
}

%%% PACKAGES
\usepackage[american,dutch]{babel}
\usepackage{xcolor}
\RequirePackage[T1]{fontenc}         % sane font encoding
\RequirePackage{lmodern}             % for sensible sans and tt font
\RequirePackage[sc,osf]{mathpazo}    % for math
\RequirePackage{microtype}
\linespread{1.1}                     % Palatino needs more leading
\frenchspacing
\normalfont
\let\subcaption\undefined
\let\subfloat\undefined
\let\subfigure\undefined
\RequirePackage{subcaption}
%% Hyperref
\RequirePackage[ocgcolorlinks,%
								breaklinks,%
								plainpages=false,%
								pdfpagelabels,%
								linktocpage]{hyperref}

\definecolor{darkred}{rgb}{0.4,0,0}
\definecolor{darkgreen}{rgb}{0,0.4,0}
\definecolor{darkblue}{rgb}{0,0,0.4}
\hypersetup{
  linkcolor=darkred,%
	citecolor=darkblue,%
	filecolor=black,%
	urlcolor=black%
}

\AtBeginDocument{\hypersetup{pdfauthor={\@author},pdftitle={\@title}}}

\RequirePackage[utf8]{inputenc}      % sane input encoding
%\DeclareUnicodeCharacter{2014}{\dash}
%\DeclareUnicodeCharacter{2022}{\item}


\RequirePackage{siunitx}		
\RequirePackage{
  graphicx, %
	%kantlipsum,
	amsmath,  %
  amssymb,  %
	amsthm,
	tikz,     % Requires at least v2.10 !!
	bm,       %
	pgfplots, % Requires at least v1.5.1 !!
}
\usetikzlibrary{calc,%
								matrix,%
								positioning,%
								decorations.markings,%
								patterns,
								matrix%
								}
								
\usepgfplotslibrary{units}
\RequirePackage{csquotes}
\MakeOuterQuote{"}



%\RequirePackage[font={sf,small}]{caption}
%\captionsetup[table]{position=top}






%\RequirePackage[open,openlevel=4]{bookmark}
%\RequirePackage{hypcap}
%
%%% biblatex
\RequirePackage[
    %backend=biber,
    hyperref,%
		backref,%
    sortcites,%
    date=short,%
    bibencoding=inputenc,%
    maxnames=3,%
    minnames=2,%
    firstinits=true,%
    sorting=nyt,%
    bibstyle=numeric,%
    citestyle=numeric-comp,%
  ]{biblatex}

\def\bibfont{\small}
\bibliography{phdthesis}
\AtEveryBibitem{%
  \clearfield{month}%
}

%\ExecuteBibliographyOptions{doi=false}
%\newbibmacro{string+doi}[1]{%
  %\iffieldundef{doi}{#1}{\href{http://dx.doi.org/\thefield{doi}}{#1}}}
%\DeclareFieldFormat{title}{\usebibmacro{string+doi}{\mkbibemph{#1}}}
%\DeclareFieldFormat[article]{title}{\usebibmacro{string+doi}{\mkbibquote{#1}}}

%\renewcommand\bibname{References}

%\usepackage{docmute}

%%%%%%%%%%%%%%%%%%%%

%% MATHS
%\RequirePackage{amsmath,amssymb,bm,cool,mathtools}%,fngp
%\@ifpackageloaded{mathpazo}{\PassOptionsToPackage{mathpazo}{flexisym}}{}
%\RequirePackage{breqn}
%\setkeys{breqn}{labelprefix=eq:}

%%%%%%%%%%%%%%%%%
%%% FIGURES


%\let\subfloat\subbottom

\def\impath{images/}
%\def\coilpath{\phdpath Coil/fig/}

%\newcommand\grf[2][]{\includegraphics[#1]{\impath #2}}

%\newcommand\ImportIfFileExists[4]{%
  %\IfFileExists{#1#2}
    %{\import{#1}{#2}#3}
    %{#4}}

% Symmetric ragged commands
\newcommand\IfOddPage{%
  \checkoddpage
  \ifoddpage\expandafter\@firstoftwo
  \else\expandafter\@secondoftwo\fi}
\newcommand\raggedout{\IfOddPage\raggedright\raggedleft}
\newcommand\raggedin{\IfOddPage\raggedleft\raggedright}

%% Subfigures
%\newsubfloat{figure}
%\newenvironment{subfigure}[1][0.4]{%
  %\begin{minipage}[t]{#1\linewidth}
    %\centering
    %\let\caption\subcaption
%}{%
  %\end{minipage}%
%}
%\newenvironment{sidefigure}[1][0.4]{%
  %\begin{minipage}[t]{#1\linewidth}
    %\centering
%}{%
  %\end{minipage}%
%}
%
%% wide:
%\newenvironment{wide}{%
  %\begin{adjustwidth*}{0pt}{-\marginparsep-\marginparwidth}
    %\raggedout
%}{%
  %\end{adjustwidth*}%
%}

%% Force font sizes in MathPSfrag & matlabfrag:
%\def\PFGstyle{\footnotesize}
%\def\matlabtextA{\footnotesize}
%\def\matlabtextB{\footnotesize}
%\def\matlabtextC{\footnotesize}

%%
%\newcommand\gridIV[5][1em]{%
  %#2\hspace{#1}#3\\
  %[#1]#4\hspace{#1}#5}
%\newcommand\gridVI[7][0.5em]{%
  %#2\hspace{#1}#3\hspace{#1}#4\\[#1]
  %#5\hspace{#1}#6\hspace{#1}#7}
%
%\strictpagecheck

% Make maths use lining numbers: (old-style look bad most-times)
%\DeclareMathSymbol{0}{0}{letters}{'060}
%\DeclareMathSymbol{1}{0}{letters}{'061}
%\DeclareMathSymbol{2}{0}{letters}{'062}
%\DeclareMathSymbol{3}{0}{letters}{'063}
%\DeclareMathSymbol{4}{0}{letters}{'064}
%\DeclareMathSymbol{5}{0}{letters}{'065}
%\DeclareMathSymbol{6}{0}{letters}{'066}
%\DeclareMathSymbol{7}{0}{letters}{'067}
%\DeclareMathSymbol{8}{0}{letters}{'070}
%\DeclareMathSymbol{9}{0}{letters}{'071}

%%%%%%%%%%%%%
%! FLOATS
%\renewcommand{\topfraction}{.8}
%\renewcommand{\bottomfraction}{.3}
%\renewcommand{\textfraction}{.15}
%\renewcommand{\floatpagefraction}{.66}
%\renewcommand{\dbltopfraction}{.66}
%\renewcommand{\dblfloatpagefraction}{.66}
%\setcounter{topnumber}{9}
%\setcounter{bottomnumber}{9}
%\setcounter{totalnumber}{20}
%\setcounter{dbltopnumber}{9}
%
%\renewenvironment{figure}[1][\fps@figure]
                 %{\edef\@tempa{\noexpand\@float{figure}[#1]}
                  %\@tempa\capstart\centering}
                 %{\end@float}
%\renewenvironment{table}[1][\fps@table]
                 %{\edef\@tempa{\noexpand\@float{table}[#1]}
                  %\@tempa\capstart\centering}
                 %{\end@float}
%

%% Floats & captions
\captionnamefont{\scshape}
%\setlength\captionwidth{0.9\linewidth}
%\changecaptionwidth

\newcommand\lofcaption[2]{\caption[#1]{#1#2}}
\DeclareRobustCommand\periodifnocomma{\@ifnextchar,{}{.}}

%%%%%%%%%%%%
% These are the varioref definitions:
% \newcommand{\varioprefix}{See~}
% \newcommand{\myvariohook}[1]{\marginpar{\small\centering \varioprefix #1}}
% \def\reftextcurrent{}
% \def\reftextfaceafter{}
% \def\reftextfacebefore{}
% \def\reftextafter{~on the \reftextvario{following}{next} page}
% \def\reftextbefore{~on the \reftextvario{previous page}{preceding page}}
% \def\reftextafter{}
% \def\reftextbefore{}
% \def\reftextfaraway#1{\myvariohook{p.\,\pageref{#1}}}
% \def\reftextpagerange#1#2{\myvariohook{pp.\,\pageref{#1}--\pageref{#2}}}

%%%%%%%%%%%%%%%%%%%%%
%! MEMOIR CUSTOMISE

\maxsecnumdepth{subsection} % number subsections
\maxtocdepth{subsection} % include subsections in ToC

\renewcommand{\cftchapterpagefont}{}
\renewcommand{\cftchapterfont}{} % no bold!
\renewcommand\cftdotsep{999} % no dots

% for page numbers:
\newcommand\thesispage{\normalfont \thepage}

%%% CHAPTERS
\makechapterstyle{phdstayla}{%
  \setlength\beforechapskip{0pt}
  \setlength\midchapskip{0pt}
  \setlength\afterchapskip{40pt}
  \renewcommand\chapnamefont{%
    \normalfont\centering\large\scshape\MakeLowercase}
  \renewcommand\chapnumfont{%
    \normalfont\centering\fontsize{60pt}{0pt}\selectfont}
  \renewcommand\chaptitlefont{%
    \normalfont\HUGE\bfseries\centering}
  \renewcommand\printchaptername{%
    \marginpar{\chapnamefont{\@chapapp}}}
  \renewcommand\chapternamenum{}
  \renewcommand\printchapternum{%
    \marginpar{\chapnumfont\thechapter}}
    \makeoddfoot{plain}{}{\thesispage}{}
}
\chapterstyle{phdstayla}


%%% SECTIONS
\newcommand\marginnum[2]{%
  \noindent
  \let\@tempa\relax
  \savebox\@tempboxa{#2}%
  %\null\marginpar{#1\@tempa}%
  #1\@tempa\quad#2}

\def\secstyle{\centering\scshape}
\def\subsecstyle{\centering\itshape}
\def\subsubsecstyle{\centering\small\itshape}

\setsecheadstyle{\marginnum\secstyle}
\setsubsecheadstyle{\marginnum\subsecstyle}
\setsubsubsecheadstyle{\marginnum\subsubsecstyle}

\setsecnumformat{\unexpanded{%
  \protected@xdef\@tempa{{\upshape\S\csname the#1\endcsname}}}}

%%%%%

\renewcommand\contentsname{Table in Contents}
\nouppercaseheads

\def\printtoctitle#1{\section*{#1}}
\def\printloftitle#1{\section*{#1}}
\def\printlottitle#1{\section*{#1}}

%%%%%

%%The first step to creating a new page header and footer is to create a new 
% page style using the \makepagestyle{name} command. So if we want to create 
% a new page style where the header contains the page number and the chapter
% -section number (if any) and title, we would start out with the following:
%%
%%\makepagestyle{mypagestyle}
%%
% To create a nice separation between the page number and the title—rather 
% than typesetting them at opposite ends of the header—we will separate them 
% with a vertical rule. Now the commands to modify the headers and footers 
% of a page style are: 
%%\makeevenhead{style}{left}{center}{right}, 
%%\makeoddhead 
%%\makeevenfoot
%%\makeoddfoot
% All with the same number of arguments. So, this means we can extend our 
% page style as follows:
%%\makeevenhead{mypagestyle}{\thepage\hskip.5cm\vrule\hskip.5cm\leftmark}{}{}
%%\makeoddhead{mypagestyle}{}{}{\rightmark\hskip.5cm\vrule\hskip.5cm\thepage}




%% Page headers
%\setlength{\headheight}{\baselineskip}
%\setlength{\headwidth}{\textwidth+\marginparsep+0.5\marginparwidth}
\makepagestyle{phdstayla}
\makepsmarks{phdstayla}{%
  \let\@mkboth\markboth%
  \def\chaptermark##1{%
    \markboth{%
      \if@mainmatter
        \textsc{Chapter \thechapter:} %
      \fi
      ##1}{##1}}%
  \def\sectionmark##1{%
    \markright{%
      \if@mainmatter
        \textsc{\S\thesection:} %
      \fi
      ##1}}}
\makerunningwidth{phdstayla}{\headwidth}
\makeheadposition{phdstayla}{flushright}{flushleft}{}{}
\makeevenhead{phdstayla}{\thesispage} {} {\small\leftmark}
\makeoddhead{phdstayla} {\small\rightmark} {} {\thesispage}
\pagestyle{phdstayla}

\makeheadrule{phdstayla}{\dimexpr\textwidth+0.5\marginparwidth+\marginparsep\relax}{0.4pt}

%%% LISTS
\renewcommand*{\descriptionlabel}[1]{\hspace\labelsep\normalfont\itshape #1}
\tightlists


\renewcommand \cftchapterfont {\scshape}
\renewcommand \cftsectionfont {\normalfont}
\renewcommand \cftsubsectionfont {\itshape\small}
\renewcommand \cftsubsectionpagefont {\upshape\small}






%======== Thm style declaration
\newtheorem{thm}{Theorem}
\newtheorem{coroll}{Corollary}
\newtheorem{define}{Definition}
\newtheorem{lem}{Lemma}
\newtheorem{rem}{Remark}

%======== Referrals 
\newcommand{\thmref}[1]{Theorem~\ref{#1}}
\newcommand{\lemref}[1]{Lemma~\ref{#1}}
\newcommand{\corref}[1]{Corollary~\ref{#1}}
\newcommand{\remref}[1]{Remark~\ref{#1}}
\newcommand{\proref}[1]{Proposition~\ref{#1}}
\newcommand{\figref}[1]{Figure~\ref{#1}}
\newcommand{\secref}[1]{Section~\ref{#1}}

%======== Shorthand notation
\newcommand{\Real}{\mathbb{R}}
\newcommand{\Realext}{\mathbb{R}_e}
\newcommand{\Complex}{\mathbb{C}}
\newcommand{\LL}{\mathcal{L}}
\newcommand{\HH}{\mathcal{H}}
\newcommand{\iw}{i\omega}
\newcommand{\eiw}{e^{i\omega}}
\newcommand{\eiwt}{e^{i2\pi\omega t}}
\newcommand{\eniw}{e^{-i\omega}}
\newcommand{\eniwt}{e^{-i2\pi\omega t}}
\newcommand{\infint}[1]{\ensuremath{\int_{-\infty}^\infty{#1}}}
\newcommand{\fourier}[1]{\infint{#1\eniwt dt}}
\newcommand{\ifourier}[1]{\infint{#1\eiwt dt}}
\newcommand{\bmatr}[1]{\begin{bmatrix}#1\end{bmatrix}}
\newcommand{\pmatr}[1]{\begin{pmatrix}#1\end{pmatrix}}
\newcommand{\smallbmatr}[1]{\ensuremath{\left[\begin{smallmatrix}#1\end{smallmatrix}\right]}}
\newcommand{\smallpmatr}[1]{\ensuremath{\left(\begin{smallmatrix}#1\end{smallmatrix}\right)}}
\newcommand{\statespace}[4]{\ensuremath{\left[\begin{array}{c|c}#1 &#2\\\hline #3 &#4\end{array}\right]}}
\newcommand{\inv}[1]{#1^{-1}}
\newcommand{\quaQ}{\mathcal{Q}}
\providecommand{\abs}[1]{\displaystyle \left|#1\right|}
\providecommand{\norm}[1]{\displaystyle \left\| #1 \right\|}
\renewcommand{\Re}[1]{\operatorname{Re}\left\{ #1 \right\}}
\renewcommand{\Im}[1]{\operatorname{Im}\left\{ #1 \right\}}

%==================================================
% ==== A style definition used in some Tikz-picture
%==================================================
\tikzset{ssmatrix/.style={matrix of math nodes,
													left delimiter={[},
													right delimiter={]},
													ampersand replacement=\&,
													nodes={
																outer sep=0,
																inner sep=0.2ex,
																font=\footnotesize
																},
													inner sep=0,
													outer sep=0,
													every left delimiter/.style={xshift=0.1ex},
													every right delimiter/.style={xshift=-0.1ex}}
}







%%% SHORTCUTS

%\RequirePackage[english]{shortwrite}

\newcommand\code[1]{\texttt{#1}}
\newcommand\note[1]{\unskip\footnote{#1}}

\DeclareRobustCommand\dash{%
  \unskip\nobreak\thinspace\textemdash\allowbreak\thinspace\ignorespaces}
\pdfstringdefDisableCommands{\def\dash{ - }}

\newcommand\acro[1]{\textsc{\MakeLowercase{#1}}}
\newcommand\newacro[1]{\@namedef{#1}{\acro{#1}}}

\newacro{FFT}
\newacro{PID}
\newacro{PI}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand\newmacro[2]{\def#1/{#2}}

\newcommand\price[2][\$]{#1#2}
\newcommand\usdollar{\textsc{u.s.}\$}


\newmacro \Matlab {Matlab}
\newmacro \dof {degree of freedom}
\newmacro \Hinf {\ensuremath{H^\infty}}
\newmacro \sic {[\textit{sic}]}



\newmacro \threeD {\textsc{3d}}
\newmacro \twoD {\textsc{2d}}

\newmacro \AC {time varying}
\newmacro \PhD {Ph.\,D\sw@ensuresingleperiod}

% COMPOUND WORDS
\newcommand \compound [2] {#1\-#2}